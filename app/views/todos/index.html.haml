=javascript_tag do
  project_id = '#{@project.id}';


-unless params[:project_id].blank?
  -@project = Project.find(params[:project_id])
  .row
    .large-10.columns
      %h1=best_in_place_if current_user_project_owner?, @project, :name
    .large-1.columns
      =current_user_project_owner? ? link_to('edit', edit_project_path(@project)).html_safe : ''
    .large-1.columns
      Join!
  .row
    .large-12.columns
      %h2="#{@project.location}"
  .row
    .large-12.columns
      %h3="#{@project.tag_list}"
  .row
    .large-12.columns.todo-description
      =best_in_place_if current_user_project_owner?, @project, :description

.row
  .large-12.columns.index-column-element

.row
  .large-12.columns
    -if signed_in? && current_user_project_owner?
      -if !params[:project_id].blank?
        = simple_form_for([@project, @todo])  do |f|
          .form-inputs
            = f.input :description, :as=> :string,  :label => false, placeholder: 'Describe your to-do'
            = f.input :project_id, :as=> :hidden, :value => @todo.project_id
          .form-actions
            = f.button :submit, :class=>"success button round", :value=>"Create New To-do", :style =>"float:right;"

- if !@open.nil?
  .row{:style=>"margin-top:10px;"}
    .large-12.columns
      %h2 To-do!
  .row
    .large-12.columns
      .opened-container
        - @open.each do |todo|
          .row.todo-element.opened
            .large-10.columns.index-column-element
              = best_in_place_if current_user_project_owner?, todo, :description
            -if can? :update, todo
              .large-1.columns.index-column-element.toggle= link_to "close", toggle_todo_path(todo), :method=> :put, :remote => true
              .large-1.columns.index-column-element= link_to 'delete', todo, :method => :delete, :data => { :confirm => 'Are you sure?' }, :class=>"alert tiny round button"
            -else
              .large-2.columns.index-column-element

-if !@closed.nil?
  .row{:style=>"margin-top:20px;"}
    .large-12.columns
      %h2 Done!
  .row
    .large-12.columns
      .closed-container
        - @closed.each do |todo|
          .row.todo-element.closed
            .large-10.columns.index-column-element
              = best_in_place_if current_user_project_owner?, todo, :description
            -if can? :update, todo
              .large-1.columns.index-column-element.toggle= link_to "open", toggle_todo_path(todo), :method=> :put, :remote => true
              .large-1.columns.index-column-element= link_to 'delete', todo, :method => :delete, :data => { :confirm => 'Are you sure?' }, :class=>"alert tiny round button"
            -else
              .large-2.columns.index-column-element
%br

.row
  .large-12.columns
